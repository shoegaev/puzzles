(()=>{"use strict";var e={325:(e,t,s)=>{s.r(t)},607:(e,t,s)=>{s.r(t)},620:(e,t,s)=>{s.r(t)},634:(e,t,s)=>{s.r(t)},987:(e,t,s)=>{s.r(t)},542:(e,t,s)=>{s.r(t)},747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppCashe=void 0,t.AppCashe=class{constructor(){this.cashObject={level:1,round:1,filledSentenceNumber:0,wordsOpacity:.3,wordsInResultLine:{currentState:[],previousState:[]}},this.appStart()}appStart(){const e=localStorage.getItem("puzzleGameData");if(null!==e){const t=JSON.parse(e);this.cashObject=t}}setRoundAndLevelNumbers(e,t){void 0!==t&&(this.cashObject.level=t),this.cashObject.round=e,this.cashObject.filledSentenceNumber=0,this.cleanWordsInresultLine(),this.saveCashe()}addWord(e,t){const{currentState:s}=this.cashObject.wordsInResultLine;this.cashObject.wordsInResultLine.previousState=[...s];const n=void 0===t?s.length:t;s.splice(n,0,e),this.saveCashe()}deleteWord(e){const{currentState:t}=this.cashObject.wordsInResultLine;this.cashObject.wordsInResultLine.previousState=[...t],t.splice(e,1),this.saveCashe()}nextSentence(){this.cashObject.filledSentenceNumber+=1,this.cleanWordsInresultLine(),this.saveCashe()}setOpacity(e){this.cashObject.wordsOpacity=e,this.saveCashe()}cleanWordsInresultLine(){this.cashObject.wordsInResultLine={currentState:[],previousState:[]}}saveCashe(){localStorage.setItem("puzzleGameData",JSON.stringify(this.cashObject))}getAssembledSentence(){return this.cashObject.wordsInResultLine.currentState}}},675:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const n=s(207),i=s(65),l=s(747);t.App=class{constructor(){this.appCashe=new l.AppCashe,this.appLoader=new n.Loader(this.appCashe),this.appLoader.loadFullData(String(this.appCashe.cashObject.level),String(this.appCashe.cashObject.round)),this.view=new i.AppView({tag:"div",cssClasses:["main-container"]},this.appLoader,this.appCashe),document.body.append(this.view.getHtmlElement())}}},207:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Loader=void 0;const n=s(413);t.Loader=class{constructor(e){this.controller=[null],this.appCashe=e,this.levelData=null,this.ImageUrl=null,this.fullData=null,this.fullDataNew=null,this.currentSentences=[],this.urlBegining="https://raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/",this.loadingWindowView=new n.LoadingWindowView(this.controller)}loadLevelData(e){const t=`${this.urlBegining}data/wordCollectionLevel${e}.json`,s=new AbortController;this.controller[0]=s;const n=fetch(t,{signal:s.signal}).then((e=>e.json())).then((e=>e));return this.levelData=n,n}loadFullData(e,t){this.loadingWindowView.show(),this.fullDataNew=this.loadLevelData(e).then((()=>{this.loadImages(t)})).then((()=>{var e;return Promise.all([null===(e=this.levelData)||void 0===e?void 0:e.then((e=>e.rounds[Number(t)-1].words)),this.ImageUrl,"место для информации об аудио"])})),this.fullDataNew.then((e=>{var t;const s=null===(t=e[0])||void 0===t?void 0:t.map((e=>e.textExample));s&&(this.currentSentences=s),this.fullData=this.fullDataNew,this.fullDataNew=null,this.loadingWindowView.remove()})).catch((e=>{this.errorHandler(e)}))}loadImages(e){var t;null===(t=this.levelData)||void 0===t||t.then((t=>{var s;const n=t.rounds[Number(e)-1].levelData.imageSrc,i=`${this.urlBegining}images/${n}`;this.ImageUrl=fetch(i,{signal:null===(s=this.controller[0])||void 0===s?void 0:s.signal}).then((e=>e.blob())).then((e=>URL.createObjectURL(e)))}))}getCurrentSentence(){return this.currentSentences[this.appCashe.cashObject.filledSentenceNumber].split(" ")}errorHandler(e){"Failed to fetch"===e.message&&this.loadingWindowView.setErrorMessage("Error, you have connection problems")}}},413:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingWindowView=void 0;const n=s(996);s(325);class i extends n.View{constructor(e){super({tag:"div",cssClasses:["loading-window"]}),this.controller=e,this.addInnerElementsParams(),this.addInnerElements(),[this.text,this.loadingBar,this.button]=this.assignProperties(),this.buttonOnClick()}addInnerElementsParams(){this.innerElementsParams=[{tag:"span",cssClasses:["loading-window__text"],textContent:"Loading..."},{tag:"div",cssClasses:["loading-window__loading-bar","loading-window__loading-bar_active"]},{tag:"div",cssClasses:["loading-window__cancel-button","button"],textContent:"Cancel"}];for(let e=0;e<4;e+=1)this.innerElementsParams.push({tag:"div",cssClasses:["loading-bar__item"],target:".loading-window__loading-bar"})}assignProperties(){const e=this.getHtmlElement().querySelector(".button"),t=this.getHtmlElement().querySelector(".loading-window__text"),s=this.getHtmlElement().querySelector(".loading-window__loading-bar");if(!(e instanceof HTMLElement&&t instanceof HTMLElement&&s instanceof HTMLElement))throw new Error;return[t,s,e]}show(){this.removeErrorMessage(),document.body.classList.add("loading-window-opened"),document.body.prepend(this.getHtmlElement()),this.getHtmlElement().style.top=`calc(1vh + ${window.scrollY}px)`}remove(){document.body.classList.remove("loading-window-opened"),this.getHtmlElement().remove()}buttonOnClick(){this.button.addEventListener("click",(()=>{var e;null===(e=this.controller[0])||void 0===e||e.abort(),this.remove()}))}setErrorMessage(e){this.text.textContent=e,this.loadingBar.classList.remove("loading-window__loading-bar_active")}removeErrorMessage(){this.text.textContent="Loading...",this.loadingBar.classList.add("loading-window__loading-bar_active")}}t.LoadingWindowView=i},310:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationMaker=void 0;class s{constructor(e){this.element=e,this.initialComputedTransition=window.getComputedStyle(e).transition,this.initialInlineTransition=e.style.transition,this.folowPointerStatus={isActive:!1,copy:null,initWidth:null,initHeight:null},this.animationDuration=.4}setTransition(e){""===this.initialComputedTransition?this.element.style.transition=e:this.element.style.transition=`${this.initialComputedTransition}, ${e}`}resetTransition(){this.element.style.transition=this.initialInlineTransition}bleach(){const e=`opacity ${this.animationDuration}s ease`;this.setTransition(e),this.element.style.opacity="0"}squeezeAndDelete(){const e=`width ${this.animationDuration}s ease`;this.setTransition(e),this.element.style.overflow="hidden",this.element.style.width=`${window.getComputedStyle(this.element).width}`,this.element.style.width="0px",setTimeout((()=>{this.element.remove()}),1e3*this.animationDuration)}insert(e,t,n){this.element.setAttribute("insertAnimation","true");const i=this.element.getBoundingClientRect(),l=this.element.style.width,o=this.element.style.height;if(null==n?void 0:n.smoothDisappearance){const e=this.element.cloneNode();if(!(e instanceof HTMLElement))throw new Error("copy is not HTMLElement");e.style.width=`${i.width}px`,e.style.height=`${i.height}px`;const t=new s(e);this.element.before(e),t.bleach(),t.squeezeAndDelete()}const a=this.element.cloneNode(!0);if(!(a instanceof HTMLElement))throw new Error("copy is not HTMLElement");a.style.position="",a.style.left="",a.style.top="";const r=new s(a);if(r.animationDuration=0,r.bleach(),r.animationDuration=.4,null==n?void 0:n.smoothInsert){a.style.width="0px";const e=`width ${this.animationDuration}s ease`;r.setTransition(e)}e[t](a);const c=a.getBoundingClientRect();this.element.style.position="absolute",this.element.style.width=`${i.width}px`,this.element.style.height=`${i.height}px`,this.element.style.top=`${i.y+window.scrollY}px`,this.element.style.left=`${i.x+window.scrollX}px`,this.element.style.zIndex="1000",document.body.append(this.element);const d=`top ${this.animationDuration/1.5}s ease, left ${this.animationDuration}s ease`;this.setTransition(d),setTimeout((()=>{(null==n?void 0:n.smoothInsert)&&(a.style.width=`${i.width}px`),(null==n?void 0:n.sameLaneAfterItem)?this.element.style.left=c.x+window.scrollX-i.width+"px":this.element.style.left=`${c.x+window.scrollX}px`,this.element.style.top=`${c.y+window.scrollY}px`,setTimeout((()=>{a.after(this.element),a.remove(),null!==this.folowPointerStatus.initHeight?this.setInitialSize():(this.element.style.width=`${l}`,this.element.style.height=`${o}`),this.element.style.position="",this.element.style.top="",this.element.style.left="",this.element.style.zIndex="",this.element.removeAttribute("insertAnimation"),this.resetTransition()}),1e3*this.animationDuration)}),0)}startfollowPointer(e,t){const n=n=>{if(!this.folowPointerStatus.isActive){this.folowPointerStatus.isActive=!0;const t=this.element.cloneNode();if(!(t instanceof HTMLElement))throw new Error;t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,this.folowPointerStatus.copy=t,new s(t).bleach(),this.element.before(t),this.element.style.position="absolute",this.element.style.zIndex="1000",document.body.append(this.element),document.body.style.overflowX="hidden",this.folowPointerStatus.initHeight=this.element.style.height,this.folowPointerStatus.initWidth=this.element.style.width,this.element.style.width=`${e.width}px`,this.element.style.opacity="0.8",this.element.style.scale="0.9"}this.element.style.top=n.pageY-(t.clientY-e.y)+"px",this.element.style.left=n.pageX-(t.clientX-e.x)+"px"};return window.addEventListener("pointermove",n),n}stopFollowPointer(e,t){window.removeEventListener("pointermove",e),document.body.style.overflow="",this.element.style.zIndex="",this.element.style.opacity="",this.element.style.scale="";const{copy:n}=this.folowPointerStatus;if(null===n)return;const i=new s(n);let l;if(n.previousElementSibling instanceof HTMLElement)l=[n.previousElementSibling,"after"];else if(n.nextElementSibling instanceof HTMLElement)l=[n.nextElementSibling,"before"];else{if(!(n.parentElement instanceof HTMLElement))throw new Error;l=[n.parentElement,"append"]}(null==t?void 0:t.smoothDisappearance)?i.squeezeAndDelete():n.remove(),(null==t?void 0:t.returnIsNeeded)&&this.insert(...l),this.folowPointerStatus.copy=null,this.folowPointerStatus.isActive=!1}setInitialSize(){null!==this.folowPointerStatus.initHeight&&null!==this.folowPointerStatus.initWidth&&(this.element.style.height=this.folowPointerStatus.initHeight,this.element.style.width=this.folowPointerStatus.initWidth,this.folowPointerStatus.initHeight=null,this.folowPointerStatus.initWidth=null)}centerOnPage(e){const t=this.element.getBoundingClientRect(),n=this.element.cloneNode(!0);if(!(n instanceof HTMLElement))throw new Error;if(e.saveEmptyPlace){const e=new s(n);e.animationDuration=0,e.bleach(),this.element.after(n)}this.element.style.position="absolute",this.element.style.top=`${t.y+window.scrollY}px`,this.element.style.left=`${t.x+window.scrollX}px`;const i=`top ${this.animationDuration}s ease, left ${this.animationDuration}s ease`;return this.setTransition(i),document.body.append(this.element),setTimeout((()=>{this.element.style.zIndex="100",this.element.style.top=`calc(50vh + ${window.scrollY}px)`,this.element.style.left=`calc(50vw + ${window.scrollX}px)`,this.element.style.transform="translate(-50%, -50%)",setTimeout((()=>{this.resetTransition()}),1e3*this.animationDuration)}),0),n}returnAfterCenter(e){const t=e.getBoundingClientRect(),s=`top ${this.animationDuration}s ease, left ${this.animationDuration}s ease`;this.setTransition(s),this.element.style.top=`${t.y+window.scrollY}px`,this.element.style.left=`${t.x+window.scrollX}px`,this.element.style.transform="",setTimeout((()=>{this.resetTransition(),this.element.style.zIndex="",this.element.style.position="",e.after(this.element),e.remove(),this.element.style.top="",this.element.style.left=""}),1e3*this.animationDuration)}}t.AnimationMaker=s},536:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ElementCreator=void 0,t.ElementCreator=class{constructor(e){this.element=null,this.createElement(e.tag),this.setCssCLasses(e.cssClasses),void 0!==e.textContent&&this.setTextContent(e.textContent),void 0!==e.atributes&&this.setElementAttributes(e.atributes)}createElement(e){this.element=document.createElement(e)}setCssCLasses(e){var t;for(let s=0;s<e.length;s+=1)null===(t=this.element)||void 0===t||t.classList.add(e[s].trim())}getElement(){if(null===this.element)throw new Error("element is null");return this.element}addInnerElements(...e){var t;for(let s=0;s<e.length;s+=1)null===(t=this.getElement())||void 0===t||t.append(e[s])}setTextContent(e){null!==this.element&&(this.element.textContent=e)}setElementAttributes(e){var t;for(let s=0;s<e.length;s+=1)null===(t=this.element)||void 0===t||t.setAttribute(e[s].name,e[s].value)}}},996:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;const n=s(536);t.View=class{constructor(e){this.viewCreator=new n.ElementCreator(e),this.innerElementsParams=[]}addInnerElements(){var e;null===(e=this.innerElementsParams)||void 0===e||e.forEach((e=>{var t;let s;s=void 0===e.quantity?1:e.quantity;for(let i=0;i<s;i++){const s=new n.ElementCreator(e);void 0===e.target?this.getHtmlElement().append(s.getElement()):null===(t=this.getHtmlElement().querySelector(e.target))||void 0===t||t.append(s.getElement())}}))}getHtmlElement(){return this.viewCreator.getElement()}removeView(){this.getHtmlElement().remove()}}},520:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ViewLoadable=void 0;const n=s(996);class i extends n.View{constructor(e,t){super(e),this.appLoader=t}}t.ViewLoadable=i},65:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppView=void 0;const n=s(520),i=s(761);class l extends n.ViewLoadable{constructor(e,t,s){super(e,t),this.appCashe=s,this.addInnerElementsParams(),this.addInnerElements(),this.gamePageView=this.createGamePageView()}addInnerElementsParams(){this.innerElementsParams=[{tag:"div",cssClasses:["modal-backdrop"]}]}createGamePageView(){const e=new i.GamePageView({tag:"main",cssClasses:["game-page"]},this.appLoader,this.appCashe);return this.getHtmlElement().append(e.getHtmlElement()),e}}t.AppView=l},788:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BottomPanelView=void 0;const n=s(520),i=s(385);s(620);class l extends n.ViewLoadable{constructor(e,t,s,n,i){var l;super(e,t),this.appCashe=i,this.gameFieldView=s,this.gameSelectorInerface=n,this.addInnerElementParams(),this.addInnerElements(),this.opacityControllerView=this.createOpacityControllerView(),this.continueButtonOnCLick(),this.buttonsStatus(),this.hideWordsButtonOnCLick(),this.checkButtonOnClick(),this.checkButtonRemoveActiveStatus(),null===(l=this.appLoader.fullDataNew)||void 0===l||l.then((()=>{this.testContinueButtonStatus(),this.testCheckButtonStatus()}))}addInnerElementParams(){this.innerElementsParams=[{tag:"div",cssClasses:["button","bottom-panel__check-button","button_disabled"],textContent:"Check"},{tag:"div",cssClasses:["button","bottom-panel__continue-button","button_disabled"],textContent:"Continue"},{tag:"div",cssClasses:["button","bottom-panel__hide-words-button"],textContent:"Hide words"}]}createOpacityControllerView(){const e=new i.OpacityControllerView({tag:"div",cssClasses:["bottom-panel__opacity-controller","opacity-controller"]},this.gameFieldView,this.appCashe);return this.getHtmlElement().append(e.getHtmlElement()),e}hideWordsButtonOnCLick(){const e=this.getHtmlElement().querySelector(".bottom-panel__hide-words-button");null==e||e.addEventListener("click",(()=>{var t;"Hide words"===(null===(t=e.textContent)||void 0===t?void 0:t.trim())?e.textContent="Show words":e.textContent="Hide words",[...this.gameFieldView.getHtmlElement().querySelectorAll(".item")].forEach((e=>{e.classList.contains("item_no-text")?e.classList.remove("item_no-text"):e.classList.add("item_no-text")}))}))}continueButtonOnCLick(){const e=this.getHtmlElement().querySelector(".bottom-panel__continue-button");null==e||e.addEventListener("click",(()=>{var t;e.classList.contains("button_disabled")||(9===this.appCashe.cashObject.filledSentenceNumber?null===(t=this.appLoader.levelData)||void 0===t||t.then((e=>{var t;const{roundsCount:s}=e,n=this.appCashe.cashObject.round,i=this.appCashe.cashObject.level;let l,o;s===n?(l=1,o=i+1):(l=n+1,o=i),this.appLoader.loadFullData(String(o),String(l)),null===(t=this.appLoader.fullDataNew)||void 0===t||t.then((()=>{this.gameFieldView.refillPanel(),this.appCashe.setRoundAndLevelNumbers(l,o),this.gameSelectorInerface.newGame(o,l)}))})):this.gameFieldView.moveToNextSentence(),e.classList.add("button_disabled"))}))}buttonsStatus(){[...this.gameFieldView.getHtmlElement().querySelectorAll(".line")].forEach((e=>{e.addEventListener("pointerdown",(e=>{if(null===this.gameFieldView.itemsEventsSetup(e))return;const t=()=>{this.testContinueButtonStatus(),this.testCheckButtonStatus(),window.removeEventListener("pointerup",t)};window.addEventListener("pointerup",t)})),e.addEventListener("click",(e=>{null!==this.gameFieldView.itemsEventsSetup(e)&&(this.testContinueButtonStatus(),this.testCheckButtonStatus())}))}))}getSentences(){return{assembledSentence:this.appCashe.getAssembledSentence(),rightSentence:this.appLoader.getCurrentSentence()}}testContinueButtonStatus(){const{assembledSentence:e,rightSentence:t}=this.getSentences(),s=this.getHtmlElement().querySelector(".bottom-panel__continue-button");null==s||s.classList.remove("button_disabled");for(let n=0;n<t.length;n+=1)if(t[n]!==e[n])return void(null==s||s.classList.add("button_disabled"))}testCheckButtonStatus(){const{assembledSentence:e,rightSentence:t}=this.getSentences(),s=document.querySelector(".bottom-panel__check-button");null==s||s.classList.remove("button_disabled"),e.length===t.length&&String(e)!==String(t)||null==s||s.classList.add("button_disabled")}checkButtonOnClick(){const e=this.getHtmlElement().querySelector(".bottom-panel__check-button");null==e||e.addEventListener("click",(()=>{if(e.classList.contains("button_disabled"))return;const{assembledSentence:t,rightSentence:s}=this.getSentences();e.classList.contains("button_active")?(e.classList.remove("button_active"),this.gameFieldView.stopHighlightItems()):(e.classList.add("button_active"),t.forEach(((e,t)=>{e!==s[t]&&this.gameFieldView.highlightItem(t)})))}))}checkButtonRemoveActiveStatus(){const e=this.getHtmlElement().querySelector(".bottom-panel__check-button");null!==e&&[...this.gameFieldView.resultLines,...this.gameFieldView.wordsLines].forEach((t=>{t.addEventListener("pointerdown",(t=>{null!==this.gameFieldView.itemsEventsSetup(t)&&e.classList.remove("button_active")}))}))}}t.BottomPanelView=l},385:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpacityControllerView=void 0;const n=s(996);class i extends n.View{constructor(e,t,s){super(e),this.gameFieldView=t,this.appCashe=s,this.addInnerElementParams(),this.addInnerElements(),[this.switch,this.filler]=this.assignProperties(),this.pointerMoveEvent(),this.clickEvent(),this.MoveSwitchAndChangeOpacity(s.cashObject.wordsOpacity)}addInnerElementParams(){this.innerElementsParams=[{tag:"div",cssClasses:["opacity-controller__toggle-switch"]},{tag:"div",cssClasses:["opacity-controller__filler"]}]}assignProperties(){const e=this.getHtmlElement(),t=this.getHtmlElement().querySelector(".opacity-controller__toggle-switch"),s=this.getHtmlElement().querySelector(".opacity-controller__filler");if(e instanceof HTMLElement&&t instanceof HTMLElement&&s instanceof HTMLElement)return[t,s];throw new Error("cannot find opacity controller elements")}pointerMoveEvent(){const e=e=>{const t=this.getHtmlElement().getBoundingClientRect();if(void 0===t)return;const s=e.pageX-t.x+window.scrollX;this.MoveSwitchAndChangeOpacity(s/t.width)},t=()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",t)};this.switch.ondragstart=()=>!1,this.getHtmlElement().ondragstart=()=>!1,this.getHtmlElement().addEventListener("pointerdown",(()=>{window.addEventListener("pointermove",e),window.addEventListener("pointerup",t)}))}clickEvent(){this.getHtmlElement().addEventListener("click",(e=>{const t=this.getHtmlElement().getBoundingClientRect(),s=e.pageX-t.x+window.scrollX;this.MoveSwitchAndChangeOpacity(s/t.width)}))}MoveSwitchAndChangeOpacity(e){let t;t=e<0?.01:e>1?.99:e,this.switch.style.left=100*t+"%",this.filler.style.width=100*t+"%",this.appCashe.setOpacity(t),this.gameFieldView.setWordsBackgroundOpacity(t)}}t.OpacityControllerView=i},986:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameFieldView=void 0;const n=s(520),i=s(368),l=s(130),o=s(310);s(634);class a extends n.ViewLoadable{constructor(e,t,s){var n;super(e,t),this.fillSentence=(e,t,s)=>{const n=[...t.children];e.forEach((e=>{const t=n.find((t=>{var s;return(null===(s=t.textContent)||void 0===s?void 0:s.trim())===e}));if(void 0===t)throw new Error("");n.splice(n.indexOf(t),1),s.append(t)}))},this.appCashe=s,this.resultPanelView=this.createResultPanel(),this.wordsPanelView=this.createWordsPanel(),this.wordsLines=[],this.resultLines=[],this.fillLinesProperties(),[this.wordsActiveLine]=this.wordsLines,[this.resultActiveLine]=this.resultLines,this.itemsPointerEvents(),this.itemsDragAndDrop(),this.stopHighlightItemsOnPointerDown(),null===(n=this.appLoader.fullDataNew)||void 0===n||n.then((()=>{this.loadPreviousGameState(),this.setWordsBackgroundOpacity(this.appCashe.cashObject.wordsOpacity)}))}loadPreviousGameState(){var e;null===(e=this.appLoader.fullData)||void 0===e||e.then((()=>{const{filledSentenceNumber:e}=this.appCashe.cashObject;for(let t=0;t<e;t+=1)this.fillSentence(this.appLoader.currentSentences[t].split(" "),this.wordsLines[t],this.resultLines[t]);0!==e&&(this.wordsActiveLine.classList.remove("words-panel__line_active"),this.resultActiveLine.classList.remove("result-panel__line_active"),this.wordsActiveLine=this.wordsLines[e],this.resultActiveLine=this.resultLines[e],this.wordsActiveLine.classList.add("words-panel__line_active"),this.resultActiveLine.classList.add("result-panel__line_active")),this.fillSentence(this.appCashe.cashObject.wordsInResultLine.currentState,this.wordsActiveLine,this.resultActiveLine)}))}createResultPanel(){const e=new i.ResultPanelView({tag:"div",cssClasses:["game-field__result-panel","result-panel"]},this.appLoader);return this.getHtmlElement().append(e.getHtmlElement()),e}createWordsPanel(){const e=new l.WordsPanelView({tag:"div",cssClasses:["game-field__words-panel","words-panel"]},this.appLoader);return this.getHtmlElement().append(e.getHtmlElement()),e}fillLinesProperties(){const e=[...this.wordsPanelView.getHtmlElement().querySelectorAll(".line")],t=[...this.resultPanelView.getHtmlElement().querySelectorAll(".line")];e.forEach((e=>{e instanceof HTMLElement&&this.wordsLines.push(e)})),t.forEach((e=>{e instanceof HTMLElement&&this.resultLines.push(e)}))}moveToNextSentence(){[this.wordsActiveLine,this.resultActiveLine].forEach((e=>{const t=e.nextElementSibling;t instanceof HTMLElement&&(e.classList.contains("result-panel__line_active")?(e.classList.remove("result-panel__line_active"),t.classList.add("result-panel__line_active"),this.resultActiveLine=t):(e.classList.remove("words-panel__line_active"),t.classList.add("words-panel__line_active"),this.wordsActiveLine=t))})),this.appCashe.nextSentence()}itemsEventsSetup(e){var t;const{currentTarget:s,target:n}=e;if(!(n instanceof HTMLElement&&s instanceof HTMLElement))throw new Error("currenTtarget or target is not HTMLelement");if(null===s||null===n)throw new Error("cannot find target or current target");if(n===s||s!==this.resultActiveLine&&s!==this.wordsActiveLine)return null;let i;if(i=(n.classList.contains("item__text")||n.classList.contains("item__image"))&&null!==n.parentElement?n.parentElement:n,"0"===i.style.opacity)return null;let l=i.previousElementSibling,o=0;for(;l;)o+=1,l=l.previousElementSibling;i.previousElementSibling instanceof HTMLElement&&"0"===i.previousElementSibling.style.opacity&&(o-=1);const a=null===(t=i.textContent)||void 0===t?void 0:t.trim();if(void 0===a)throw new Error("Cannot read word frow item");return{line:s,item:i,index:o,word:a}}itemsPointerEvents(){[...this.wordsLines,...this.resultLines].forEach((e=>{e.addEventListener("click",(e=>{const t=this.itemsEventsSetup(e);if(null===t)return;const{line:s,item:n,index:i,word:l}=t,a=new o.AnimationMaker(n),r={smoothDisappearance:!0};s.classList.contains("result-panel__line")?(a.insert(this.wordsActiveLine,"append",r),this.appCashe.deleteWord(i)):(a.insert(this.resultActiveLine,"append",r),this.appCashe.addWord(l,this.appCashe.cashObject.wordsInResultLine.currentState.length))}))}))}itemsDragAndDrop(){[...this.wordsLines,...this.resultLines].forEach((e=>{e.addEventListener("pointerdown",(e=>{const{target:t}=e;t instanceof HTMLElement&&(t.ondragstart=()=>!1,t.onmousedown=()=>!1);const s=this.itemsEventsSetup(e);if(null===s)return;const{line:n,item:i,index:l,word:a}=s;if("true"===i.getAttribute("insertAnimation"))return;const r=i.getBoundingClientRect(),c=new o.AnimationMaker(i);let d,h,m=!1;window.addEventListener("pointermove",d=t=>{(Math.abs(e.clientX-t.clientX)>15||Math.abs(e.clientY-t.clientY)>15)&&(n===this.resultActiveLine&&this.appCashe.deleteWord(l),h=c.startfollowPointer(r,e),m=!0,window.removeEventListener("pointermove",d))});const u=e=>{var t,s,o;if(window.removeEventListener("pointermove",d),!m)return;i.style.display="none";const p=document.elementFromPoint(e.clientX,e.clientY);if(!(p instanceof HTMLElement))return;let g;if(i.style.display="",g=((null==p?void 0:p.classList.contains("item__text"))||(null==p?void 0:p.classList.contains("item__image")))&&null!==p.parentElement&&"0"!==p.parentElement.style.opacity?p.parentElement:(null==p?void 0:p.classList.contains("item"))?p:null,null!==g&&((null===(t=g.parentElement)||void 0===t?void 0:t.classList.contains("result-panel__line_active"))||(null===(s=g.parentElement)||void 0===s?void 0:s.classList.contains("words-panel__line_active")))){const t=null==g?void 0:g.getBoundingClientRect();let s;c.stopFollowPointer(h,{smoothDisappearance:!0}),s=g.parentElement===n&&g.getBoundingClientRect().x>r.x?{smoothDisappearance:!0,smoothInsert:!0,sameLaneAfterItem:!0}:{smoothDisappearance:!0,smoothInsert:!0};const i=[...(null===(o=g.parentElement)||void 0===o?void 0:o.children)||[]].indexOf(g);if(-1===i)throw new Error("incorrect insertItemIndex");e.clientX-t.x>=t.width/2?(c.insert(g,"after",s),g.parentElement===this.resultActiveLine&&("0"===g.style.opacity||l<=i&&n===this.resultActiveLine?this.appCashe.addWord(a,i):this.appCashe.addWord(a,i+1))):(c.insert(g,"before",s),g.parentElement===this.resultActiveLine&&(l<i&&n===this.resultActiveLine?this.appCashe.addWord(a,i-1):this.appCashe.addWord(a,i)))}else if(p===this.resultActiveLine||p===this.wordsActiveLine)p===n?c.insert(p,"append",{smoothInsert:!0,sameLaneAfterItem:!0}):c.insert(p,"append",{smoothInsert:!0}),c.stopFollowPointer(h,{smoothDisappearance:!0}),p===this.resultActiveLine&&this.appCashe.addWord(a);else{let e;e=n===this.wordsActiveLine?this.resultActiveLine:this.wordsActiveLine,2*Math.abs(e.getBoundingClientRect().y-i.getBoundingClientRect().y)<Math.abs(n.getBoundingClientRect().y-i.getBoundingClientRect().y)?(c.insert(e,"append",{smoothDisappearance:!0}),c.stopFollowPointer(h,{smoothDisappearance:!0}),e===this.resultActiveLine&&this.appCashe.addWord(a)):(c.stopFollowPointer(h,{returnIsNeeded:!0}),n===this.resultActiveLine&&this.appCashe.addWord(a,l))}window.removeEventListener("pointerup",u)};window.addEventListener("pointerup",u)}))}))}refillPanel(){[...this.getHtmlElement().querySelectorAll(".item")].forEach((e=>{e.remove()})),this.wordsPanelView.fillPanel(),this.wordsActiveLine.classList.remove("words-panel__line_active"),this.resultActiveLine.classList.remove("result-panel__line_active"),[this.wordsActiveLine]=this.wordsLines,[this.resultActiveLine]=this.resultLines,this.wordsActiveLine.classList.add("words-panel__line_active"),this.resultActiveLine.classList.add("result-panel__line_active")}setWordsBackgroundOpacity(e){var t;null===(t=this.appLoader.fullData)||void 0===t||t.then((()=>{if(e<0||e>1)throw new Error("incorrect opacity value");[...this.getHtmlElement().querySelectorAll(".item__text")].forEach((t=>{if(t instanceof HTMLElement){const s=window.getComputedStyle(t);t.style.backgroundColor=`${s.backgroundColor.split(",").splice(0,3).join(",")}, ${e}`}}))}))}highlightItem(e){this.resultActiveLine.children[e].classList.add("item_wrong")}stopHighlightItems(){[...this.resultActiveLine.children].forEach((e=>{e.classList.remove("item_wrong")}))}stopHighlightItemsOnPointerDown(){[...this.resultLines,...this.wordsLines].forEach((e=>{e.addEventListener("pointerdown",(e=>{null!==this.itemsEventsSetup(e)&&this.stopHighlightItems()}))}))}}t.GameFieldView=a},368:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResultPanelView=void 0;const n=s(520);class i extends n.ViewLoadable{constructor(e,t){super(e,t),this.addInnerElementsParams(),this.addInnerElements()}addInnerElementsParams(){for(let e=0;e<10;e+=1)this.innerElementsParams.push({tag:"div",cssClasses:["result-panel__line","line"]});this.innerElementsParams[0].cssClasses.push("result-panel__line_active")}}t.ResultPanelView=i},130:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WordsPanelView=void 0;const n=s(520),i=s(536);class l extends n.ViewLoadable{constructor(e,t){var s;super(e,t),this.addInnerElementsParams(),this.addInnerElements(),null===(s=this.appLoader.fullDataNew)||void 0===s||s.then((()=>{this.fillPanel()}))}addInnerElementsParams(){for(let e=0;e<10;e+=1)this.innerElementsParams.push({tag:"div",cssClasses:["words-panel__line","line"]});this.innerElementsParams[0].cssClasses.push("words-panel__line_active")}fillPanel(){var e;null===(e=this.appLoader.fullData)||void 0===e||e.then((e=>{var t;const s=[...this.getHtmlElement().querySelectorAll(".line")],n=null===(t=e[0])||void 0===t?void 0:t.map((e=>e.textExample)),l=e[1];if(void 0===n||null===l)throw new Error("incorrect game data");n.forEach(((e,t)=>{const n=e.split(" "),o=n.join("").length,a=n.length;let r=0;n.forEach((e=>{const n={tag:"span",cssClasses:["item__text"],textContent:e},c=new i.ElementCreator({tag:"div",cssClasses:["item"]}),d=new i.ElementCreator(n);c.addInnerElements(d.getElement()),s[t].append(c.getElement());const h=100*e.length/o+(o/a-e.length)*(100/(2*o));c.getElement().style.width=`${h}%`;const m=new Image;m.className="item__image",m.src=l,m.style.height="1000%",m.style.width=100/h*100+"%",m.style.top=`-${100*t}%`,m.style.left=`-${r/h*100}%`,c.addInnerElements(m),r+=h}))}))}))}}t.WordsPanelView=l},761:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GamePageView=void 0;const n=s(520),i=s(154),l=s(986),o=s(788);s(987);class a extends n.ViewLoadable{constructor(e,t,s){super(e,t),this.appCashe=s,this.gameFieldView=this.createGameFieldView(),this.gameSelectorInterface=this.createGameSelectorInterfaceView(),this.bottomPanelView=this.createBottomPanelView()}createGameSelectorInterfaceView(){const e=new i.GameSelectorInerfaceView({tag:"div",cssClasses:["game-page__game-selector ","game-selector"]},this.appLoader,this.appCashe,this.gameFieldView);return this.getHtmlElement().prepend(e.getHtmlElement()),e}createGameFieldView(){const e=new l.GameFieldView({tag:"div",cssClasses:["game-page__game-field","game-field"]},this.appLoader,this.appCashe);return this.getHtmlElement().append(e.getHtmlElement()),e}createBottomPanelView(){const e=new o.BottomPanelView({tag:"div",cssClasses:["game-page__bottom-panel","bottom-panel"]},this.appLoader,this.gameFieldView,this.gameSelectorInterface,this.appCashe);return this.getHtmlElement().append(e.getHtmlElement()),e}}t.GamePageView=a},154:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameSelectorInerfaceView=void 0;const n=s(520),i=s(536),l=s(310);s(542);class o extends n.ViewLoadable{constructor(e,t,s,n){super(e,t),this.appCashe=s,this.config={levelNumber:s.cashObject.level,roundNumber:s.cashObject.round},this.gameFieldView=n,this.levelSelector=null,this.roundSelector=null,this.configureView(),this.ItemsOnClick(),this.buttonOnClick(),this.closeButtonOnClick()}configureView(){this.addInnerElementsParams(),this.addInnerElements(),this.assignSelectors(),this.addRounds()}addInnerElementsParams(){this.innerElementsParams=[{tag:"div",cssClasses:["game-selector__close-button","close-button","button"]},{tag:"div",cssClasses:["close-button__stick"],target:".game-selector__close-button"},{tag:"div",cssClasses:["close-button__stick"],target:".game-selector__close-button"},{tag:"div",cssClasses:["game-selector__game-information"]},{tag:"div",cssClasses:["game-information__heading"],target:".game-selector__game-information",textContent:"Game information"},{tag:"div",cssClasses:["game-information__information"],target:".game-selector__game-information"},{tag:"div",cssClasses:["game-information__level"],textContent:`Level: ${this.config.levelNumber}`,target:".game-information__information"},{tag:"div",cssClasses:["game-information__round"],textContent:`Round: ${this.config.roundNumber}`,target:".game-information__information"},{tag:"div",cssClasses:["game-selector__selectors"]},{tag:"div",cssClasses:["game-selector__level-selector","selector"],target:".game-selector__selectors"},{tag:"div",cssClasses:["game-selector__round-selector","selector"],target:".game-selector__selectors"},{tag:"div",cssClasses:["game-selector__button","button"],textContent:"change level"}];for(let e=1;e<7;e+=1)this.innerElementsParams.push({tag:"div",cssClasses:["selector__item"],target:".game-selector__level-selector"},{tag:"span",cssClasses:["selector__item-text"],textContent:`Level ${e}`,target:".game-selector__level-selector .selector__item:last-child"},{tag:"div",cssClasses:["selector__item-status"],target:".game-selector__level-selector .selector__item:last-child"})}assignSelectors(){const e=this.getHtmlElement().querySelector(".game-selector__round-selector"),t=this.getHtmlElement().querySelector(".game-selector__level-selector");e instanceof HTMLElement&&t instanceof HTMLElement&&(this.roundSelector=e,this.levelSelector=t)}addRounds(){var e;if(null===this.roundSelector)throw new Error("roundSelector is null");this.roundSelector.innerHTML="",null===(e=this.appLoader.levelData)||void 0===e||e.then((e=>{var t;const s=e.roundsCount;for(let e=1;e<=s;e+=1){const s=new i.ElementCreator({tag:"div",cssClasses:["selector__item"]}),n=new i.ElementCreator({tag:"span",cssClasses:["selector__item-text"],textContent:`Round ${e}`}),l=new i.ElementCreator({tag:"div",cssClasses:["selector__item-status"]});s.getElement().append(n.getElement(),l.getElement()),null===(t=this.roundSelector)||void 0===t||t.append(s.getElement())}}))}ItemsOnClick(){[this.levelSelector,this.roundSelector].forEach((e=>{null==e||e.addEventListener("click",(e=>{const{target:t,currentTarget:s}=e;if(!(t!==this.levelSelector&&t!==this.roundSelector&&t instanceof HTMLElement&&s instanceof HTMLElement))return;let n;if(t.classList.contains("selector__item"))n=t;else{if(!t.classList.contains("selector__item-text")&&!t.classList.contains("selector__item-status"))return;n=t.parentElement}(null==n?void 0:n.classList.contains("selector__item_active"))||(s.classList.contains("game-selector__level-selector")&&this.changeLevelrounds(t),this.ItemsClassAndConfigChange(s,n),this.buttonStatus())}))}))}ItemsClassAndConfigChange(e,t){var s;const n=null===(s=null==t?void 0:t.textContent)||void 0===s?void 0:s.trim();if(null==n)throw new Error(`text is ${n}`);const i=n.split(" ");"Level"===i[0]?this.config.levelNumber=Number(i[1]):this.config.roundNumber=Number(i[1]),[...e.children].forEach((e=>{e.classList.remove("selector__item_active")})),null==t||t.classList.add("selector__item_active")}changeLevelrounds(e){if(!(e instanceof HTMLElement))return;const t=null==e?void 0:e.innerText.trim().slice(-1);this.appLoader.loadLevelData(t),this.addRounds()}buttonStatus(){const e=this.getHtmlElement().querySelector(".game-selector__button"),t=[this.levelSelector,this.roundSelector];let s=!1,n=!1;t.forEach((e=>{const t=null==e?void 0:e.children;if(void 0!==t)for(let i=0;i<t.length;i+=1)if(t[i].classList.contains("selector__item_active")){e===this.levelSelector?s=!0:n=!0;break}})),s&&n?null==e||e.classList.remove("button_disabled"):null==e||e.classList.add("button_disabled")}fillGameInformation(){const e=this.getHtmlElement().querySelector(".game-information__round"),t=this.getHtmlElement().querySelector(".game-information__level");null!==e&&null!==t&&(t.textContent=`Level: ${this.config.levelNumber}`,e.textContent=`Round: ${this.config.roundNumber}`)}buttonOnClick(){const e=this.getHtmlElement().querySelector(".game-selector__button");null!==e&&e.addEventListener("click",(()=>{var t;e.classList.contains("button_disabled")&&this.getHtmlElement().classList.contains("game-selector_open")||(this.getHtmlElement().classList.contains("game-selector_open")?(this.appLoader.loadFullData(String(this.config.levelNumber),String(this.config.roundNumber)),null===(t=this.appLoader.fullDataNew)||void 0===t||t.then((()=>{this.closeModalWindow(),this.fillGameInformation(),this.gameFieldView.refillPanel(),this.appCashe.setRoundAndLevelNumbers(this.config.roundNumber,this.config.levelNumber)}))):(this.openModalWindow(),this.addRounds(),this.buttonStatus()))}))}closeButtonOnClick(){const e=this.getHtmlElement().querySelector(".game-selector__close-button");null==e||e.addEventListener("click",(()=>{this.closeModalWindow()}))}openModalWindow(){const e=this.getHtmlElement().querySelector(".game-selector__button");if(null===e)return;const t=this.getHtmlElement(),s=new l.AnimationMaker(t);s.animationDuration=.8,s.centerOnPage({saveEmptyPlace:!0}),setTimeout((()=>{var s;if(t.classList.add("game-selector_open"),null!==this.levelSelector){const e=[...null===(s=this.levelSelector)||void 0===s?void 0:s.children];e.forEach((e=>{e.classList.remove("selector__item_active")})),e[this.config.levelNumber-1].classList.add("selector__item_active")}e.textContent="play",document.body.classList.add("modal-window-opened")}),0)}closeModalWindow(){const e=this.getHtmlElement().querySelector(".game-selector__button");if(null===e)return;const t=this.getHtmlElement(),s=new l.AnimationMaker(t),n=document.querySelector(".game-page .game-page__game-selector");if(!(n instanceof HTMLElement))throw new Error;s.animationDuration=.8,s.returnAfterCenter(n),t.classList.remove("game-selector_open"),e.classList.remove("button_disabled"),e.textContent="change level",document.body.classList.remove("modal-window-opened")}newGame(e,t){this.config={levelNumber:e,roundNumber:t},this.fillGameInformation()}}t.GameSelectorInerfaceView=o}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,s),l.exports}s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=s(675);s(607),new e.App})()})();